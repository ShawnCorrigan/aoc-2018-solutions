<?php
$input = <<<EOT
                /----------------------------------------------------------------------------------------------\                                      
   /------------+-----\                                                                   /--------------------+-----------------\                    
   |            |     |                                      /-------------------->-------+<-------------------+------\         /+-------------\      
   |            |     |                                  /---+------\                     |                    |      |         ||             |      
   |            |     |                               /--+---+------+---------------------+--------------------+------+---------++---\  /------+----\ 
   |            |     |                               |  |   |      |         /-----------+--------------------+------+---------++\  |  |      |    | 
   |            |     |    /----------------\         |  |   |      |         |           |               /----+------+---------+++--+--+------+----+\
   |            |     |    |  /-------------+---------+--+---+------+---------+-----------+-----\         |    |      |         |||  |  |      |    ||
   |            |     |    |  |             |         |  |   | /----+---------+-----------+-----+---------+----+----->+----\    |||  |  |      |    ||
   |            |     |    |  |             |         |  |   | |    |    /----+-----------+-----+---------+----+------+----+----+++--+\ |      |    ||
   |            |     |    |  |             |     /---+--+---+-+----+\   |    |           |     |         |    |      |    |    |||  || |      |    ||
   |            |     |    |  |             |     |   |  |   | |/---++---+----+-----------+-----+---------+--\ |      |    |    |||  || |      |    ||
   |            |     |    |  |             |     |   |  |   | ||   ||   |    |           |     |         |  | |      |    |    |||  || |      |    ||
   |            |   /-+----+--+-------------+---\ |   |  |   | ||   ||/--+----+-----------+-----+---------+--+-+----\ |    |    |||  || |      |    ||
   | /----------+---+-+----+--+-------------+---+-+---+--+---+-++---+++--+----+-----------+-----+------\  |  | |    | |    |    |||  || |      |    ||
   | |          |   | |    |  |             |   | |   |  |   | ||   |||  |    |           |     |      |  |  | |    | |    |    |||  || \------+----/|
   | |          |   | |    |  |             |/--+-+---+--+---+-++---+++--+----+-----------+-----+------+--+--+-+----+-+<---+----+++\ ||        |     |
   | |         /+---+-+----+--+-------------++-\| |   |  |   | ||   |||  |    |   /-------+-----+------+--+<-+-+-\  | |    |    |||| ||        |     |
   | |         ||   | |    |  |             || || |   |  |   | ||   |||  |    |   |       |     |      |  |  | | |  | |/---+----++++-++----\   |     |
   |/+--------\||   | |    | /+-----------\ || || |   |  |   | ||   |||  |    |   |       |   /-+------+--+--+-+-+--+-++---+----++++-++----+---+--\  |
   |||        |||   | |    | ||           | || || |   |  |   | ||   |||  |    |   |   /---+---+-+------+--+--+-+-+--+-++---+----++++-++----+-\ |  |  |
   |||        |||   | |    | ||        /--+-++-++-+---+\ |  /+-++---+++--+----+---+---+---+---+>+------+--+--+-+-+--+-++---+-\  |||| ||    | | |  |  |
   |||      /-+++---+-+\   | ||        |  | || || \---++-+--++-++---+/|  |    |   |   |   |   | |      |  |  | | |  | ||   | |  |||| ||    | | |  |  |
   |||      | |||   | ||   |/++--------+--+-++-++-----++-+--++-++---+-+--+----+---+---+---+---+-+\     |  |  | | |  | ||   | |  |||| ||    | | |  |  |
   |||      | |||   | ||   ||||        |  | || ||     || |  |\-++---+-+--+----+---+---+---+---+-++-----+--+--+-+-+--+-/|   | |  |||| ||    | | |  |  |
   |||      | |||   \-++---++++--------+--+-++-+/     || |  |  ||   | |  |    |   |   |   |   | ||     |  |  | | |  |  | /-+-+--++++-++----+-+-+--+\ |
   |||      | |||     ||   ||||        |  | || |    /-++-+--+--++---+-+--+----+---+---+---+---+-++-\   |  |  | | |  |  | | | |  |||| ||    | | |  || |
   |||     /+-+++-----++---++++--------+--+-++-+----+-++-+--+--++---+-+--+----+---+---+---+---+-++-+---+--+\ | | |  |  | | | |  \+++-++----+-+-/  || |
   |||     || ||\-----++---++++--------+--+-++-+----+-++-+--+--++---+-+--+----+---+---+---+---+-++-+---+--++-+-/ |  |  | | | |   ||| ||    | |    || |
   |||     || ||    /-++---++++--------+--+-++-+----+-++-+--+--++---+-+--+----+---+---+---+---+-++-+---+--++-+---+--+--+-+-+-+--\||| ||    | |    || |
   |||     || ||    | ||   ||||        |  | || |    | || |  |  ||   | |  |    |  /+---+---+---+-++-+---+--++-+---+--+--+-+-+-+--++++-++----+-+----++\|
   |||     || ||    | ||   ||||        |  | || |    | ||/+--+--++---+-+--+----+\ ||   |   |   | || |   |  || |   |  |  | | | |  |||| ||    | |    ||||
   |||     || ||    | || /-++++--------+--+-++-+----+-++++--+--++---+-+--+----++-++---+---+---+-++\|   |  || |   |  |  | | | |  |||| ||    | |    ||||
   |||     |\-++----+-+/ | ||||    /---+--+-++-+----+-++++--+--++---+-+--+----++-++---+---+---+-++++---+\ || |   |  |  | | | |  |||| ||    | |    ||||
   |||     |  ||    | |  | ||||    |   |  | || |    | ||||  |  ||   | |  |    || ||   |   |   | ||||   || || |   | /+--+-+-+\|  |||| ||    | |    ||||
   |||     |  ||    | |  | ||||    |   |  | || |    | ||||  |  ||   | |  |    || ||   |   |   | ||||   || || |   | ||  | | |||  |||| ||    | |    ||||
   |||     |  || /--+-+--+-++++----+---+--+-++-+----+-++++--+--++---+-+--+----++-++---+---+---+-++++---++-++-+---+-++\ | | |||  |||| ||    | |    ||||
/--+++-----+--++-+--+-+--+-++++----+---+--+-++-+----+-++++--+--++---+-+--+--\ || ||   |   | /-+-++++---++-++-+---+-+++-+-+-+++--++++-++---\| |    ||||
|  |||     |  || |  \-+--+-++++----+---+--+-++-+----+-++++--+--++---+-+--+--+-++-++---+---+-+-+-++++---++-++-+---+-+++-+-+-+++--/||| ||   || |    ||||
|  |||     |  || |  /-+--+-++++----+---+--+-++-+----+-++++--+--++-\ | |  |  | || ||   |   |/+-+-++++---++-++-+---+\||| | | |||   ||| ||   || |    ||||
|  |||     |  || |  | |  | ||||    |   |/-+-++-+----+-++++--+--++-+-+-+--+--+-++-++---+---+++-+-++++---++-++-+\  ||||| | | |||   ||| ||   || |    ||||
| /+++-----+--++-+--+-+--+-++++----+---++-+-++-+----+-++++--+--++-+-+-+--+--+-++-++---+---+++-+-++++---++\|| ||  ||||| | | |||   ||| ||   || |    ||||
| ||||     |  || |  | |  | ||||    |   || | || |    | \+++--+--++-+-+-+--+--+-++-++---+---+++-+-++++---+++++-++--+++++-+-+-+++---+++-/|   || |    ||||
| ||||     \--++-+--+-+--+-++++----+---++-+-++-+----+--+++--+--++-+-+-+--+--+-++-++---+---+++-+-++++---++++/ ||  ||||| | | |||   |||  |   || |    ||||
| ||||        || |  | |  | ||||    |   || | ||/+----+--+++-\|  || | | |  |  | || ||   |/--+++-+-++++\  ||||  ||  ||||| | | |||   |||  |   || |    ||||
| ||||        || |  | |  | ||||    |   || | ||||/---+--+++-++--++-+>+-+--+--+-++-++---++-\||| | |||||  ||||  ||  ||||| | | |||   |||  |   || |    ||||
| ||||        || |  | |  | ||||    |   || | |||||   |  ||| |\--++-+-+-+--+--+-++-++---++-++++-+-+++++--++++--++--+++++-+-+-++/   |||  |   || |    ||||
| ||||        || |  | |  | ||||    |   || | |||||   |  ||| |   || |/+-+--+--+-++-++---++-++++-+-+++++--++++--++--+++++-+-+-++\   |||  |   || |    ||||
| ||||       /++-+--+-+--+-++++----+---++-+-+++++---+-\||| |   || ||| |  |  | || ||   || |||| | |||||  ||||  ||  ||||| | | |||   |||  |   || v    ||||
| ||||  /----+++-+--+-+--+-++++----+---++-+-+++++---+-++++-+---++-+++\|  |  | \+-++---++-++++-+-+++++--++++--++--+++++-+-+-+++---+/|  |   || |    ||||
| ||||  |/---+++-+--+-+--+-++++----+---++-+-+++++---+-++++-+---++-+++++--+--+--+\||   || |||| | |||||  ||||  ||  ||||| | | |||   | |  |   || |    ||||
| ||||  ||   ||| |  | |  | ||||    |   || | |||||/--+-++++-+---++-+++++--+--+--++++---++-++++-+-+++++--++++-\||  ||\++-+-+-+/|   | |  |   || |    ||||
| |\++--++---+++-+--+-/  | ||||    |   \+-+-++++++--+-+/|| |/--++-+++++--+--+--++++---++-++++-+-+++++--++++-+++--++-++-+-+-+-+---+-+--+-\ || |    ||||
| | ||  ||   ||| |  |    | ||||    |    | | ||||||  | | || ||  || |||||  |  |  ||||   || ||\+-+-+++++--++++-+++--+/ || | | | |   | |  | | || |    ||||
| | ||  ||/--+++-+--+----+-++++----+----+-+-++++++--+-+-++-++--++-+++++--+--+-\||||   || || | | |||||  |||| |||  |  || | | | |   | |  | | || |    ||||
| | ||  |||  ||| |  |    | ||||    |    | | ||||||  | | || ||  || ||||\--+--+-+++++---++-++-+-+-+++++--++++-+++--+--/| | | | |   | |  | | || |    ||||
| | \+--+++--+/| |  |    | ||||    |    | | ||||||  | | || ||  || ||||   |  | |||||   || |\-+-+-+++++--++++-+++--+---+-+-+-+-+---/ |  | | || |    ||||
| |  |  |||  | | |  |    | ||||    |    | | ||||||/-+-+-++-++--++-++++---+--+-+++++---++-+--+-+-+++++--++++-+++--+---+-+\| | |     |  | | || |    ||||
| |  |  |||  | | |  \----+-++++----+----+-+-+++++++-+-+-++-++--++-/|||   |  | |||||   ||/+--+-+-+++++--++++-+++\ |   | ||| | |     |  | | || |    ||||
| |  |  |||  | | |       | ||||    |    | | ||\++++-+-+-++-/|/-++--+++---+--+-+++++-\ |||| /+-+-+++++--++++-++++-+---+-+++\| |     |  | | || |    ||||
| |  | /+++--+-+-+-------+-++++----+----+-+-++-++++-+-+-++--++\||  |||   |  | ||||| | |||| || | |||||  |||| |||| |   | ||||| |     |  |/+-++-+---\||||
| |  | ||||  | | |       | ||||    |    | | || |||| | | ||  |||||  |||   |  | ||||| | |||| || | |||||  |||| |||| |   | ||||| |     |  ||| || |   |||||
| |  | ||||  | | |       | ||||    |    | | || |||| | | ||  |||||  |||   |  | ||||\-+-++++-++-+-+++++--++++-++++-/   | ||||| |     |  ||| || |   |||||
| |  | ||||  | | |       | ||||    |    | | || |||| | | ||  |||||  |||   |  | ||||  | ||||/++-+-+++++--++++-++++-----+-+++++-+--\/-+--+++-++-+--\|||||
| |  | ||||  | | |       | ||||    |    | | || |||| | | ||  |||||  |||   |  | ||||  | |\+++++-+-++++/  |||\-++++-----+-+++++-+--++-+--+++-++-+--+++++/
| |  | ||||  | | |     /-+-++++----+--\ | | || |||| | | ||  |||||  |||   |/-+-++++--+-+-+++++-+\||||   |||  ||||     | ||||| |  || |  ||| || |  ||||| 
| |  | ||||  | | |     | | ||||    |  | | | || |||| | | ||  |||||  |||   || | ||||  | | ||||| ||||||   |||  ||||     | ||||| |  || |  ||| || |  ||||| 
| |  | ||||  | | |     | | \+++----+--+-+-+-/| |||| | | ||  |||||  |||   || | ||||  | | ||||| ||||||   |||  ||||     | ||||| |  || |  ||| || |  ||||| 
| |  | |||\--+-+-+-----+-+--+++----+--+-+-+--+-++++-+-+-++--+++++--+++---++-+-/|||  |/+-+++++-++++++---+++\ ||||     | ||||v |  || |  ||| || |  ||||| 
| |  | |||   | | |     | |  |||    |  | |/+--+-++++-+-+\||  |||||  |||   || |  |||  ||| |||||/++++++---++++-++++-----+-+++++-+--++-+-\||| || |  ||||| 
| |  | |||   | | |/----+-+--+++\   |  | |||  | ||\+-+-++++--+++++--+++---++-+--+++--+++-++++++++++++---++++-/|||    /+-+++++-+--++-+-++++-++-+-\||||| 
| |  | |||   | | ||    | |  |\++---+--+-++/  | || | | ||||  ||||\--+++---++-+--+++--+++-++++++++++++---++++--/||    || ||||| |  || | |||| || | |||||| 
|/+--+-+++---+-+-++----+-+--+-++---+--+-++---+-++-+-+-++++--++++---+++---++-+--+++--+++-++++++++++++-\ ||||   ||    || ||||| |  || | |||| || | |||||| 
|||  | |||   | | ||  /-+-+--+-++---+--+-++---+-++-+-+-++++--++++-\ |||   || |  |||/-+++-++++++++++++-+-++++---++----++-+++++-+--++-+\|||| || | |||||| 
^||  | |||   | | ||  | | |  | ||   |  | ||   \-++-+-+-++++--++++-+-+++---++-+--++++-+++-++++++++++++-+-++++---++----++-+++++-+--++-/||||| || | |||||| 
|||  | |||   | | ||  | | |  | ||   |/-+-++-----++-+-+-++++--++++-+-+++---++-+--++++-+++>++++++++++++-+-++++---++----++-+++++-+\ ||  ||||| || | |||||| 
|||  | \++---+-+-++--+-+-+--+-++---++-+-++-----++-+-+-++++--++/| | |||   || |  |||| ||| \+++++++++++-+-++++---+/    || ||||| || |\--+++++-++-+-+/|||| 
|||  |  ||   | | ||  | | |  | ||   || | ||     || | | ||||  || | |/+++---++-+--++++-+++--+++++++++++-+-++++\  |     || ||||| || |   ||||| || | | |||| 
|||  |  ||   | | ||  | | |  | ||   || | ||    /++-+-+-++++--++-+-+++++--\|| |  |||| |||  ||||||||||| | |||||  | /---++-+++++-++-+---+++++\|| | | |||| 
|||  |  ||   | | ||  | | |  | ||   || | ||    ||| | | ||||  || | |||||  ||| |  |||| ||\--+++++++++++-+-+++++--+-+---++-+++++-++-+---++++++++-/ | |||| 
|||  |  ||   | | || /+-+-+--+-++---++-+-++----+++\| | ||||  || | |||||  |\+-+--++++-++---+++++++++++-+-+++++--+-+---++-+++++-++-+---++/|||||   | |||| 
|||  |  ||   |/+-++-++-+-+--+-++---++-+-++----+++++\| ||||  || | |||||  | | |  |||| ||   ||||||||||| | |||||  | |   || ||||| || |   || |||||   | |||| 
|||  |  ||   ||| || || | |  | ||   || | ||    ||||||| ||||  |\-+-+++++--+-+-+--++++-/|   ||||||||||| | |||||  | |   || ||||| || |   || |||||   | |||| 
|||  |  ||   |||/++-++-+-+--+-++---++-+-++----+++++++-++++--+--+-+++++--+-+-+--++++--+---+++++++++++\| |||||  | |   || ||||| || |   || |||||   | |||| 
|||  |  ||   |||||| || |/+--+-++---++-+-++----+++++++-++++--+--+-+++++--+-+-+--++++--+-\ v|||||||||||| |||||  | |   || ||||| || |   || |||||   | |||| 
|||  |  ||   |||||| || |||  | ||   || | ||    ||||||| ||||  |  | |||||  | | |  ||||  | | |||||||||||||/+++++--+-+---++-+++++-++-+---++-+++++---+-++++\
|||  |  ||   |||||| || |||/-+-++---++\| ||    ||||||| ||||  |  \-+++++--+-+-+--++++--+-+-+++++++++++++++++++--+-+---++-++++/ || |   || |||||   | |||||
|||  |  ||   |||||| || |||| | ||   |||| ||    ||||||\-++++--+----+++++--+-+-+--++++--+-+-++++++++++/||||||||  | |   || ||||  || |   || |||||   | |||||
|||  |  ||   |||||| || |||| | ||   |||| ||    ||||||  ||||  |    |||||  | | |  |||v  \-+-++++++++++-++++++/|  | |   || ||||  || |   || |||||   | |||||
|||  |  ||  /++++++-++\|||| |/++---++++-++----++++++--++++--+----+++++--+-+-+--++++----+-++++++++++-++++++-+--+-+---++-++++--++-+\  || |||||   | |||||
|||  |  ||  |\+++++-+++++++-++++---++++-++----++++++--/||\--+----+++/|  | | |  ||||    | |||||\++++-++++++-+--+-+---++-++++--++-++--++-+++++---+-+/|||
|||  |  ||  | ||||| ||||||| ||||   |||| ||  /-++++++---++---+----+++-+--+-+-+--++++----+-+++++-++++-++++++-+--+-+---++-++++--++\||  || |||||   | | |||
|||  |  ||  | ||||| ||||||| ||||   |||| ||  | ||||||   ||   |    ||| |  | | |  ||||    | ||||\-++++-++++++-+--+-+---++-++++--+++++--+/ |||||   | | |||
|||  \--++--+-+++++-+++++++-++++---++++-++--+-++++++---++---+----+++-+--+-+-+--++++----+-++++--++++-+++/|| |  | |   || ||||  |||||  |  |||||   | | |||
||| /---++--+-+++++-+++++++-++++---++++-++--+-++++++---++---+----+++-+--+-+-+--++++----+-++++-\|||| ||| || |  | |   || ||||  |||||  |  |||||   | | |||
||| |   ||  | ||||| ||||||| ||||   |||| ||  | ||||||   ||   |    ||| |  | | |  ||||    | |||| ||||| ||| || |  | |   || \+++--+++++--+--++++/   | | |||
||| |   ||  | ||||| ||||||| ||||   |\++-++--+-++++++---++---+----+++-+--+-+-+--++++----+-++++-+++++-+++-++-+--+-+---++--+++--+/|||  |  ||||    | | |||
||| |   ||  | ||||| ||||||| ||||/--+-++-++--+-++++++---++---+---\||| |  | | | /++++----+-++++-+++++-+++-++-+\ | |   ||  |||  | |||  |  ||||    | | |||
|\+-+---++--+-+++++-+++++++-+++++--+-++-++--+-++++++---++---+---++++-+--+-+-+-+++++----+-++++-+++++-+/| || || | |   ||  |||  | |||  |  ||||    | | |||
| | |   ||  | ||||| ||||||| |\+++--+-++-++--+-++++++---++---+---++++-+--+-+-+-+++++----+-++++-+++++-+-+-++-++-+-+--<++--+++--+-++/  |  ||||    | | |||
| | |   ||  | ||||| |||\+++-+-+++--+-+/ ||  | ||||||   ||   \---++++-+--+-+-+-+++++----+-++++-+++++-+-+-++-++-+-+---++--+++--+-++---+--+/||    | | |||
| | |   \+--+-+++++-+++-+++-+-+++--+-+--++--+-++++++---++-------++++-/  | | | |||\+----+-++++-+++++-+-+-++-++-+-+---++--+++--+-++---+--+-++----+-+-+/|
| | |    |  | ||||| ||| ||| \-+++--+-+--++--+-++++++---++-------++++----+-+-+-+++-+----+-++++-+++/| | | || || | |   ||  |||  | ||   |  | ||    | | | |
| | |    |  | ||||| ||| |||   |||  | |/-++--+-++++++---++-------++++----+-+-+-+++-+----+-++++-+++-+-+-+-++-++-+-+---++--+++--+-++---+--+\||    | | | |
| | |    |  | ||||| ||| |||   |||  | || ||/-+-++++++---++-------++++----+-+-+-+++-+\   | |||| ||| | | | || || | |   ||  |||  | ||   |  ||||    | | | |
| | |    |  |/+++++-+++-+++---+++--+\|| ||| | ||||||   ||     /-++++----+-+-+-+++-++---+-++++-+++-+-+-+-++-++-+-+---++--+++--+-++---+--++++\   | | | |
| | |    |  ||||||| ||| |||   |||  |||| ||| | ||||||   ||  /--+-++++----+-+-+-+++-++---+-++++-+++-+-+-+-++-++-+-+>\ ||  |||  | ||   |  |||||   | | | |
| | |    |  ||||||| ||| |||   |||  |||| ||| | ||||||   ||  |  | ||||    | \-+-+++-++---+-++++-+/| | | | || || | | | ||  |||  | ||   |  |||||   | | | |
| | |    |  ||||||| ||| |||   |||/-++++-+++-+-++++++---++--+--+-++++----+---+-+++-++---+-++++-+-+-+-+-+-++-++-+-+-+-++--+++--+-++---+-\|||||   | | | |
| | |    |  ||||||| ||| |||   \+++-++++-+++-+-++++++---++--+--+-++++----+---+-+++-++---+-++++-+-/ | | | || || | | | ||  |||  | ||   | ||||||   | | | |
| | |    |  ||||||| ||| |||    ||| |||| \++-+-++++++---++--+--+-++++----+---+-+++-++---+-++++-+---+-+-+-++-++-/ | | ||  |||  | ||   | ||||||   | | | |
| | |  /-+--+++++++-+++-+++----+++-++++--++-+-++++++---++--+--+-++++----+---+-+++-++---+-++++-+---+-+-+-++-++---+-+\||  |||  | ||   | ||||||   | | | |
| | |  | |  ||||||| ||| |||    ||| ||||  || | ||\+++---++--+--+-++++----+---+-+++-++---+-/||| |   | | | || ||   | ||||  |||  | ||   | ||||||   | | | |
| | |  | |  ||||||| ||| |||    ||| ||||  || | || |||   ||  |  | ||||    |   | ||| ||   |  ||| |   | | | || ||   | ||||  |||  | ||   | ||||||   | | | |
| | |  | |  |||\+++-+++-+++----+++-++++--++-+-+/ |||   ||  |  | ||\+----+---+-+++-++---+--+++-+---+-+-+-++-/|   | ||||  |||  | ||   | ||||||   | | | |
| | |  | |  ||| ||| ||| |||    ||| ||||  || | |  |||   ||  |  | || |    |   | ||| ||   |  ||| |   | | | ||  |   \-++++--+++--+-++---+-+++/||   | | | |
| | |  | |  ||| ||| |\+-+++----+++-++++--++-+-+--+++---++--+--+-+/ |    |   | ||| ||   |  ||| |   | | | ||  |     ||||  |||  | ||   | ||| ||   | | | |
| | |  | |  ||| ||| | | |||    ||| ||||  || | |  |||   ||  |  | |  |    |   | ||| ||   |  ||| |   | | | ||  |     ||||  |||  | ||   | ||| ||   | | | |
| \-+--+-+--+++-+++-+-+-+++----+++-++++--++-+-+--+++---++--+--+-+--+----+---+-+++-++---+--+++-+---+-+-+-+/  |     ||||  |||  | ||   | ||| ||   | | | |
|   |  | |  ||| ||| | | |||    ||| ||||  || | |  |||   ||  |  | |  |    |   | ||| ||   |  ||| |   | | | |   |     ||||  |||  | ||   | ||| ||   | | | |
|   |  | |  ||| ||| | | |||    ||| ||||  || | \--+++---++--+--+-+--+----/   | ||| ||   |  ||| |   | | | |   |     ||\+--+++--+-++---+-+++-++---/ | | |
\---+--+-+--+++-+++-+-+-+++----+++-++++--++-+----+++---++--+--+-+--+--------/ ||| ||   |  ||| |   | | | |   |     || |  |||  | ||   | ||| ||     | | |
    |  | |  ||| ||| | | |||    ||| ||||  || |    |||   ||  |  \-+--+----------+++-++---+--+++-+---+-+-+-+---+-----++-+--+++--+-++---+-+++-+/     | | |
    |  | |  ||| ||| | | \++----+++-++++--++-+----+++---++--+----+--+----------+++-++---/  ||| |   | | | |   |     || |  |||  | ||   | |\+-+------/ | |
    |  | |  ||| ||| | |  ||    ||| ||||  || |    |||   ||  |    |/-+----------+++-++--\   ||| |   | | | |   |     || |  |||  | ||   | | | |        | |
    |  | |  ||| ||| | |  ||    ||| ||||  || |    |||   ||  |    || |          ||| ||  |   ||| |  /+-+-+-+---+-----++-+--+++--+-++---+-+-+\|        | |
    |  | |  ||| ||| | |  ||    ||| ||||  || |    |||   ||  |    || \----------+++-++--+---+++-+--++-+-+-+---+-----++-+--+++--/ ||   | | |||        | |
    |  | |  ||| ||| | |  \+----+++-++++--++-+----+++---++--+----++------------+++-++--+---+++-+--+/ | | |   |     || |  |||    ||   | | |||        | |
    |  | |  |\+-+++-+-+---+----+++-+/||  || |    |||   ||  |    ||            ||| ||  |   \++-+--+--+-+-+---+-----++-+--+++----+/   | | |||        | |
    |  | |  | | ||| \-+---+----+++-+-++--++-+----/||   ||  |    ||            ||| ||  |    || |  |  | | |   |     || |  |||    |    | | |||        | |
    |  | |  | \-+++---+---+----+++-+-++--++-+-----+/   ||  |    ||            \++-++--+----++-+--+--+-+-+---/     || |  |\+----+----+-+-+++--------/ |
    |  | |  |   |||   |   v    ||| \-++--++-+-----+----++--+----++-------------++-++--+----++-+--+--+-+-/         || |  | |    |    | | |||          |
    |  | |  |   |||   |   |    |\+---++--++-+-----+----++--+----/|             || || /+----++-+--+--+-+-----------++-+--+-+----+---\| | |||          |
    |  \-+--+---+++---+---+----+-+---++--++-+-----+----++--+-----+-------------++-++-++----++-+--+--+-+-----------+/ |  | |    |   || | |||          |
    |    |  |   |||   |   |    | |   ||  || |     |    |\--+-----+-------------/| || ||    || |  |  | |           |  |  | |    |   || | |||          |
    |    |  |   |||   |   |    | |   ||  || \-----+----+---+-----+--------------+-++-++----++-+--+--+-+-----------+--+--+-+----/   || | |||          |
    |    |  |   |||   |   |    | |   ||  ||       |    |   |     \--------------+-++-+/    \+-+--+--+-+-----------+--+--+-/        || | |||          |
    |    |  |   |||   |   |    | |   ||  \+-------+----/   |                    | || |      | |  |  | \-----------+--+--+----------++-+-+++----------/
    |    |  |   |\+---+---+----+-+---++---+-------+--------+--------------------+-++-+------+-+--+--+-------------+--/  |          || | |||           
    |    \--+---+-+---+---+----+-+---++---+-------+--------+--------------------/ || |      | |  |  |             |     |          || | |||           
    |       |   | |   |   |    | |   ||   |       |        \----------------------++-+------+-+--+--+-------------/     |          || | |||           
    |       |   | |   |   |    | |   ||   |       |                               || \------+-+--+--+-------------------+----------/| | |||           
    |       |   | |   |   |    | \---++---+-------+-------------------------------++--------+-+--+--+-------------------+-----------+-/ |||           
    |       |   | |   |   |    |     ||   |       |                               ||        \-+--+--+-------------------+-----------+---++/           
    |       \---+-+---/   |    |     ||   |       |                               \+----------+--+--+-------------------+-----------/   ||            
    \-----------+<+-------+----+-----++---+-------+--------------------------------+----------/  |  |                   |               ||            
                \-+-------+----+-----++---+-------+--------------------------------+-------------+--/                   |               ||            
                  |       \----+-----/\---+-------+--------------------------------+-------------+----------------------+---------------/|            
                  \------------/          |       \--------------------------------+-------------+----------------------/                |            
                                          \----------------------------------------/             \---------------------------------------/            
EOT;

function check_colision($cart, $cart_key, $carts) {
  unset($carts[$cart_key]);

  foreach ($carts as $key => $cart2) {
    if ($cart['x'] == $cart2['x'] && $cart['y'] == $cart2['y']) {
      return true;
    }
  }

  return false;
}

function tick(&$carts, $track, $directions, $make_movement, $turns) {
  array_multisort(array_column($carts, 'y'), SORT_ASC, array_column($carts, 'x'), SORT_ASC, $carts);

  foreach ($carts as $key => &$cart) {
    $make_movement[$cart['direction']]($cart);
    
    if (check_colision($cart, $key, $carts)) {
      return $cart['x'] . ',' . $cart['y'];
    }

    $underlying_track = $track[$cart['y']][$cart['x']];

    if (in_array($underlying_track, ['/','\\'])) {
      $cart['direction'] = $directions[$cart['direction']][$underlying_track];
    } elseif ($underlying_track === '+') {
      $this_turn = array_shift($cart['turns']);

      $cart['direction'] = $turns[$cart['direction']][$this_turn];

      $cart['turns'][] = $this_turn;
    }
  }

  return false;
}

$turns = [
  'v' => [
    'left'     => '>',
    'straight' => 'v',
    'right'    => '<',
  ],
  '>' => [
    'left'     => '^',
    'straight' => '>',
    'right'    => 'v',
  ],
  '<' => [
    'left'     => 'v',
    'straight' => '<',
    'right'    => '^',
  ],
  '^' => [
    'left'     => '<',
    'straight' => '^',
    'right'    => '>',
  ],
];

$directions = [
  'v' => [
    '/'  => '<',
    '\\' => '>',
  ],
  '>' => [
    '/'  => '^',
    '\\' => 'v',
  ],
  '<' => [
    '/'  => 'v',
    '\\' => '^',
  ],
  '^' => [
    '/'  => '>',
    '\\' => '<',
  ],
];

$make_movement = [
  'v' => function(&$cart) {
    $cart['y']++;
  },
  '>' => function(&$cart) {
    $cart['x']++;
  },
  '<' => function(&$cart) {
    $cart['x']--;
  },
  '^' => function(&$cart) {
    $cart['y']--;
  },
];

$underlying_tracks = [
  'v' => '|',
  '>' => '-',
  '<' => '-',
  '^' => '|',
];

$carts = [];

$track = explode(PHP_EOL, $input);

foreach ($track as $row_key => &$row) {
  $row = str_split($row);

  foreach ($row as $col_key => &$col) {
    if (in_array($col, ['<','^','v','>'])) {
      $carts[] = [
        'x' => $col_key,
        'y' => $row_key,
        'direction' => $col,
        'turns' => [
          'left',
          'straight',
          'right',
        ]
      ];

      $col = $underlying_tracks[$col];
    }
  }
}

$has_collision = tick($carts, $track, $directions, $make_movement, $turns);

while ($has_collision === false) {
  $has_collision = tick($carts, $track, $directions, $make_movement, $turns);
}

echo $has_collision;
